<!-- Finestra Modale del Profilo -->
<div id="profileModal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
  <div class="bg-gray-900 rounded-lg shadow-lg w-full max-w-4xl p-6 relative border border-gray-600">

    <!-- Bottone per chiudere la finestra -->
    <button onclick="closeProfileModal()" class="absolute top-2 right-2 text-gray-400 hover:text-white">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>

    <!-- Header simile al terminale -->
    <header class="flex items-center justify-between mb-6">
      <div class="title-program text-white text-2xl font-semibold">Profilo</div>
      <div class="button-container">
        <div class="button minus">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14" />
          </svg>
        </div>
        <div class="button resize">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6" />
          </svg>
        </div>
        <div class="button exit" onclick="closeProfileModal()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </div>
      </div>
    </header>

    <!-- Informazioni del Profilo -->
    <div class="flex items-center mb-6">
      <div class="text-center mb-6">
        <% if current_user.profile_image.attached? %>
          <%= image_tag current_user.profile_image_thumbnail, class: "rounded-full mx-auto shadow-xl w-40 h-40 object-cover border-4 border-purple-600" %>
        <% else %>
          <%= image_tag('profile-placeholder.png', alt: 'Profile Image', class: 'rounded-full mx-auto shadow-xl w-40 h-40 object-cover border-4 border-purple-600') %>
        <% end %>
      </div>
      <div class="ml-6 text-gray-300">
        <h2 class="text-2xl font-semibold mb-2">Profilo</h2>
        <p><strong>Nome:</strong> <%= @user.username %></p>
        <p><strong>Email:</strong> <%= @user.email %></p>
      </div>
    </div>

    <!-- Lista Amici -->
    <div class="mb-6">
      <h3 class="text-xl font-semibold text-purple-400 mb-4">Amici</h3>
      <ul class="list-disc list-inside space-y-2 text-gray-300">
        <% current_user.friends.each do |friend| %>
          <li><%= link_to friend.username, user_profile_path(friend), class: 'text-blue-400 hover:text-blue-500' %></li>
        <% end %>
      </ul>
    </div>

    <!-- Proposte Accettate -->
    <div class="mb-6">
      <h3 class="text-xl font-semibold text-green-400 mb-4">Proposte Accettate</h3>
      <div class="overflow-hidden rounded-2xl shadow-lg bg-gray-800">
        <table class="w-full border border-gray-700 rounded-2xl">
          <thead>
          <tr class="bg-gray-900">
            <th class="px-6 py-4 text-center text-xl font-semibold text-white">Descrizione</th>
            <th class="px-6 py-4 text-center text-xl font-semibold text-white">Test Case</th>
          </tr>
          </thead>
          <tbody>
          <% @accepted_challenges.each do |challenge| %>
            <tr class="border-b border-gray-700 hover:bg-gray-700 transition-colors duration-200">
              <td class="px-6 py-4 text-white"><%= challenge.description %></td>
              <td class="px-6 py-4 text-white">
                <ul class="list-disc list-inside space-y-2">
                  <% challenge.test_cases.each do |test_case| %>
                    <li>Input: <%= test_case.input_example %>, Output: <%= test_case.expected_output %></li>
                  <% end %>
                </ul>
              </td>
            </tr>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Proposte Rifiutate -->
    <div class="mb-6">
      <h3 class="text-xl font-semibold text-red-400 mb-4">Proposte Rifiutate</h3>
      <div class="overflow-hidden rounded-2xl shadow-lg bg-gray-800">
        <table class="w-full border border-gray-700 rounded-2xl">
          <thead>
          <tr class="bg-gray-900">
            <th class="px-6 py-4 text-center text-xl font-semibold text-white">Descrizione</th>
            <th class="px-6 py-4 text-center text-xl font-semibold text-white">Test Case</th>
            <th class="px-6 py-4 text-center text-xl font-semibold text-white">Motivo del Rifiuto</th>
          </tr>
          </thead>
          <tbody>
          <% @rejected_challenges.each do |challenge| %>
            <tr class="border-b border-gray-700 hover:bg-gray-700 transition-colors duration-200">
              <td class="px-6 py-4 text-white"><%= challenge.description %></td>
              <td class="px-6 py-4 text-white">
                <ul class="list-disc list-inside space-y-2">
                  <% challenge.test_cases.each do |test_case| %>
                    <li>Input: <%= test_case.input_example %>, Output: <%= test_case.expected_output %></li>
                  <% end %>
                </ul>
              </td>
              <td class="px-6 py-4 text-white"><%= challenge.rejection_reason %></td>
            </tr>
          <% end %>
          </tbody>
        </table>
      </div>
    </div>

  </div>
</div>

<script>
    function toggleProfileModal() {
        const modal = document.getElementById('profileModal');
        modal.classList.toggle('hidden');
    }

    function closeProfileModal() {
        const modal = document.getElementById('profileModal');
        modal.classList.add('hidden');
    }
</script>
